# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JifJbGUFkM9WfymDHDbUezarDSzYxS3f
"""

#Make sure u have the right access to the ngok token to be able to open a web server and rub it for you 
# necessary libraries :
import streamlit as st
from keras.models import load_model
import cv2
import numpy as np

# mounting the  Google Drive :
from google.colab import drive
drive.mount('/content/drive')

# Load the saved model :
model = load_model('/content/drive/MyDrive/trained_model.h5')

# function to preprocess and predict the age of my model:
def predict_age(image):
    # Preprocess the image (resize, normalize, etc.)
    img = cv2.resize(image, (128, 128))
    img = np.expand_dims(img, axis=0)
    img = img / 255.0

    # Make the prediction
    age = model.predict(img)[0][0]

    return int(age)

# Create the Streamlit app :
def main():
    st.title("Age Detection App")

    # Upload the image :
    uploaded_file = st.file_uploader("Choose an image", type=['jpg', 'png', 'jpeg'])

    if uploaded_file is not None:
        # Read the image:
        image = cv2.imdecode(np.fromstring(uploaded_file.read(), np.uint8), cv2.IMREAD_COLOR)

        # Display the image:
        st.image(image, channels="BGR")

        # Make the prediction:
        age = predict_age(image)
        st.write(f"Predicted age: {age} years")

# Run the Streamlit app:
if __name__ == "__main__":
    main()

